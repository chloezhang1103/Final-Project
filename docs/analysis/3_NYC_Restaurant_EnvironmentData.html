<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Collecting and Processing Environmental and Contextual Data for NYC Restaurants – Final Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-9ea0a49c779b6fc496fdb60b6bf00fef.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-9b6c00cfdd9f97392670a293d2d1e528.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Collecting and Processing Environmental and Contextual Data for NYC Restaurants</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/course-icon.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/KkkumaLuo" title="MUSA 550 GitHub" class="quarto-navigation-tool px-1" aria-label="MUSA 550 GitHub"><i class="bi bi-github"></i></a>
    <a href="https://github.com/whitneypig" title="MUSA 550 GitHub" class="quarto-navigation-tool px-1" aria-label="MUSA 550 GitHub"><i class="bi bi-github"></i></a>
    <a href="https://github.com/chloezhang1103" title="MUSA 550 GitHub" class="quarto-navigation-tool px-1" aria-label="MUSA 550 GitHub"><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About Us</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../analysis/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/1_Data_Cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Cleaning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/2_DatingScore_Restaurants.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dating Score Evalution</span></a>
  </div>
</li>
          <li class="sidebar-item">
 <span class="menu-text">analysis/3_NYC_Restaurant_Environmental_Insights.ipynb</span>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/4_interactive_map.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4_interactive_map.html</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/5_K-means_to Identify_Best Dating Places.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Identify Characteristics that Define an Ideal Dating Spot</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#proximity-to-parking-lots" id="toc-proximity-to-parking-lots" class="nav-link active" data-scroll-target="#proximity-to-parking-lots">01 Proximity to Parking Lots</a></li>
  <li><a href="#public-transportation-accessibility" id="toc-public-transportation-accessibility" class="nav-link" data-scroll-target="#public-transportation-accessibility">02 Public Transportation Accessibility</a></li>
  <li><a href="#proximity-to-romantic-locations" id="toc-proximity-to-romantic-locations" class="nav-link" data-scroll-target="#proximity-to-romantic-locations">03 Proximity to Romantic Locations</a></li>
  <li><a href="#import-noises-complaints-data" id="toc-import-noises-complaints-data" class="nav-link" data-scroll-target="#import-noises-complaints-data">Import Noises Complaints Data</a></li>
  <li><a href="#import-median-hh-income-data" id="toc-import-median-hh-income-data" class="nav-link" data-scroll-target="#import-median-hh-income-data">Import Median HH Income Data</a></li>
  <li><a href="#clean-the-price-column" id="toc-clean-the-price-column" class="nav-link" data-scroll-target="#clean-the-price-column">Clean the ’Price‘ Column</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Collecting and Processing Environmental and Contextual Data for NYC Restaurants</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>This section focuses on gathering, cleaning, and processing relevant environmental and contextual factors that may influence restaurant performance and customer experience. By integrating data on public transportation, proximity to romantic locations, noise pollution, socioeconomic conditions, and pricing, we constructed a comprehensive dataset. These processed variables will serve as key inputs for further evaluation and analysis.</p>
<div id="10bc2c50-6782-45f6-8eed-666ef595b89b" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>review <span class="op">=</span> gpd.read_file(<span class="st">"restaurants_reviews_final.geojson"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>info <span class="op">=</span> gpd.read_file(<span class="st">"restaurants_info.geojson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The history saving thread hit an unexpected error (OperationalError('attempt to write a readonly database')).History will not be written to the database.</code></pre>
</div>
</div>
<div id="b00a3592-35c9-4e6e-acfd-6458c67449cf" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>info.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">categoryName</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">neighborhood</th>
<th data-quarto-table-cell-role="th">street</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">postalCode</th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">location</th>
<th data-quarto-table-cell-role="th">totalScore</th>
<th data-quarto-table-cell-role="th">reviewsCount</th>
<th data-quarto-table-cell-role="th">url</th>
<th data-quarto-table-cell-role="th">latitude</th>
<th data-quarto-table-cell-role="th">longitude</th>
<th data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Phil-Am Kusina</td>
<td>$10–20</td>
<td>Filipino restaurant</td>
<td>556 Tompkins Ave., Staten Island, NY 10305</td>
<td>Rosebank</td>
<td>556 Tompkins Ave.</td>
<td>Staten Island</td>
<td>10305</td>
<td>New York</td>
<td>{'lat': 40.6124623, 'lng': -74.071427}</td>
<td>4.7</td>
<td>320</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>40.612462</td>
<td>-74.071427</td>
<td>POINT (-74.07143 40.61246)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>H &amp; L Bagels</td>
<td>$1–10</td>
<td>Bagel shop</td>
<td>8818 3rd Ave, Brooklyn, NY 11209</td>
<td>Fort Hamilton</td>
<td>8818 3rd Ave</td>
<td>Brooklyn</td>
<td>11209</td>
<td>New York</td>
<td>{'lat': 40.6216254, 'lng': -74.0320368}</td>
<td>4.6</td>
<td>276</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>40.621625</td>
<td>-74.032037</td>
<td>POINT (-74.03204 40.62163)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Coszcal De Allende</td>
<td>$30–50</td>
<td>Mexican restaurant</td>
<td>7506 3rd Ave, Brooklyn, NY 11209</td>
<td>Bay Ridge</td>
<td>7506 3rd Ave</td>
<td>Brooklyn</td>
<td>11209</td>
<td>New York</td>
<td>{'lat': 40.6313072, 'lng': -74.0281532}</td>
<td>4.4</td>
<td>331</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>40.631307</td>
<td>-74.028153</td>
<td>POINT (-74.02815 40.63131)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>E.A.T.</td>
<td>$30–50</td>
<td>American restaurant</td>
<td>1064 Madison Ave, New York, NY 10028</td>
<td>Manhattan</td>
<td>1064 Madison Ave</td>
<td>New York</td>
<td>10028</td>
<td>New York</td>
<td>{'lat': 40.7773172, 'lng': -73.9616247}</td>
<td>2.9</td>
<td>1061</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>40.777317</td>
<td>-73.961625</td>
<td>POINT (-73.96162 40.77732)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Dowling's at The Carlyle</td>
<td>$100+</td>
<td>Restaurant</td>
<td>35 E 76th St, New York, NY 10021</td>
<td>Manhattan</td>
<td>35 E 76th St</td>
<td>New York</td>
<td>10021</td>
<td>New York</td>
<td>{'lat': 40.7744222, 'lng': -73.9631514}</td>
<td>3.7</td>
<td>61</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>40.774422</td>
<td>-73.963151</td>
<td>POINT (-73.96315 40.77442)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="c429154e-cd6f-4b0a-8c5c-160fd00214cc" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>columns_to_keep <span class="op">=</span> [<span class="st">'title'</span>, <span class="st">'price'</span>, <span class="st">'categoryName'</span>, <span class="st">'address'</span>, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'neighborhood'</span>, <span class="st">'street'</span>, <span class="st">'url'</span>, <span class="st">'geometry'</span>]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>info_cleaned <span class="op">=</span> info[columns_to_keep]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>info_cleaned <span class="op">=</span> info_cleaned.to_crs(epsg<span class="op">=</span><span class="dv">4326</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>info_cleaned.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">categoryName</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">neighborhood</th>
<th data-quarto-table-cell-role="th">street</th>
<th data-quarto-table-cell-role="th">url</th>
<th data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Phil-Am Kusina</td>
<td>$10–20</td>
<td>Filipino restaurant</td>
<td>556 Tompkins Ave., Staten Island, NY 10305</td>
<td>Rosebank</td>
<td>556 Tompkins Ave.</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (-74.07143 40.61246)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>H &amp; L Bagels</td>
<td>$1–10</td>
<td>Bagel shop</td>
<td>8818 3rd Ave, Brooklyn, NY 11209</td>
<td>Fort Hamilton</td>
<td>8818 3rd Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (-74.03204 40.62163)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Coszcal De Allende</td>
<td>$30–50</td>
<td>Mexican restaurant</td>
<td>7506 3rd Ave, Brooklyn, NY 11209</td>
<td>Bay Ridge</td>
<td>7506 3rd Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (-74.02815 40.63131)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>E.A.T.</td>
<td>$30–50</td>
<td>American restaurant</td>
<td>1064 Madison Ave, New York, NY 10028</td>
<td>Manhattan</td>
<td>1064 Madison Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (-73.96162 40.77732)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Dowling's at The Carlyle</td>
<td>$100+</td>
<td>Restaurant</td>
<td>35 E 76th St, New York, NY 10021</td>
<td>Manhattan</td>
<td>35 E 76th St</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (-73.96315 40.77442)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Parking availability can be a significant factor for customers driving to restaurants. We calculated the distance to the nearest parking lot for each restaurant, providing a realistic measure of parking convenience.</p>
<section id="proximity-to-parking-lots" class="level2">
<h2 class="anchored" data-anchor-id="proximity-to-parking-lots">01 Proximity to Parking Lots</h2>
<div id="49d4adf9-a3c0-4e26-baa2-7b8d90144770" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shapely.geometry <span class="im">import</span> Point</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>parking_lot <span class="op">=</span> pd.read_csv(<span class="st">"DOITT_PARKING_LOT.csv"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>parking_lot_gdf <span class="op">=</span> gpd.GeoDataFrame(parking_lot, </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                                  geometry<span class="op">=</span>gpd.GeoSeries.from_wkt(parking_lot[<span class="st">'the_geom'</span>]),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                                  crs<span class="op">=</span><span class="st">"EPSG:4326"</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>parking_lot_gdf <span class="op">=</span> parking_lot_gdf.to_crs(epsg<span class="op">=</span><span class="dv">32618</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>parking_lot_gdf[<span class="st">'centroid'</span>] <span class="op">=</span> parking_lot_gdf.geometry.centroid</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>parking_lot_points <span class="op">=</span> parking_lot_gdf.set_geometry(<span class="st">'centroid'</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>parking_lot_points.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">the_geom</th>
<th data-quarto-table-cell-role="th">SOURCE_ID</th>
<th data-quarto-table-cell-role="th">FEAT_CODE</th>
<th data-quarto-table-cell-role="th">SUB_CODE</th>
<th data-quarto-table-cell-role="th">STATUS</th>
<th data-quarto-table-cell-role="th">SHAPE_Leng</th>
<th data-quarto-table-cell-role="th">SHAPE_Area</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">centroid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>MULTIPOLYGON (((-73.97910559725612 40.69049642...</td>
<td>21500000001</td>
<td>5000</td>
<td>500000</td>
<td>Unchanged</td>
<td>778.318836</td>
<td>32676.073685</td>
<td>MULTIPOLYGON (((586259.846 4504901.215, 586260...</td>
<td>POINT (586255.612 4504869.513)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>MULTIPOLYGON (((-73.97943374194773 40.69316130...</td>
<td>21500000002</td>
<td>5000</td>
<td>500000</td>
<td>Updated</td>
<td>3737.772791</td>
<td>108080.622252</td>
<td>MULTIPOLYGON (((586228.684 4505196.711, 586228...</td>
<td>POINT (586161.547 4505138.654)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>MULTIPOLYGON (((-73.9832399249372 40.702812757...</td>
<td>21500000003</td>
<td>5000</td>
<td>500000</td>
<td>Unchanged</td>
<td>442.772495</td>
<td>5407.860486</td>
<td>MULTIPOLYGON (((585894.692 4506264.356, 585893...</td>
<td>POINT (585879.620 4506256.939)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>MULTIPOLYGON (((-73.98189157977659 40.70310347...</td>
<td>21500000004</td>
<td>5000</td>
<td>500000</td>
<td>Unchanged</td>
<td>284.623893</td>
<td>4027.729151</td>
<td>MULTIPOLYGON (((586008.226 4506297.946, 586007...</td>
<td>POINT (585995.753 4506294.055)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>MULTIPOLYGON (((-73.98594989444811 40.70232449...</td>
<td>21500000005</td>
<td>5000</td>
<td>500000</td>
<td>Unchanged</td>
<td>1567.687419</td>
<td>122903.007235</td>
<td>MULTIPOLYGON (((585666.379 4506207.509, 585666...</td>
<td>POINT (585687.785 4506167.346)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="ee12996c-e765-4b11-8323-4e833067c7c5" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>info_cleaned <span class="op">=</span> info_cleaned.to_crs(epsg<span class="op">=</span><span class="dv">32618</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="68ea08ff-c962-42a7-bc67-fa07deebe040" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> osmnx <span class="im">as</span> ox</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.spatial <span class="im">import</span> cKDTree</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>restaurant_coords <span class="op">=</span> np.array(<span class="bu">list</span>(<span class="bu">zip</span>(info_cleaned.geometry.x, info_cleaned.geometry.y)))</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>parking_coords <span class="op">=</span> np.array(<span class="bu">list</span>(<span class="bu">zip</span>(parking_lot_points.geometry.x, parking_lot_points.geometry.y)))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> cKDTree(parking_coords)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>distances, indices <span class="op">=</span> tree.query(restaurant_coords)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>info_cleaned[<span class="st">'nearest_parking_distance'</span>] <span class="op">=</span> distances</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>info_cleaned.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">categoryName</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">neighborhood</th>
<th data-quarto-table-cell-role="th">street</th>
<th data-quarto-table-cell-role="th">url</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">nearest_parking_distance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Phil-Am Kusina</td>
<td>$10–20</td>
<td>Filipino restaurant</td>
<td>556 Tompkins Ave., Staten Island, NY 10305</td>
<td>Rosebank</td>
<td>556 Tompkins Ave.</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (578550.560 4496152.507)</td>
<td>23.399102</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>H &amp; L Bagels</td>
<td>$1–10</td>
<td>Bagel shop</td>
<td>8818 3rd Ave, Brooklyn, NY 11209</td>
<td>Fort Hamilton</td>
<td>8818 3rd Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (581871.546 4497205.555)</td>
<td>131.466634</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Coszcal De Allende</td>
<td>$30–50</td>
<td>Mexican restaurant</td>
<td>7506 3rd Ave, Brooklyn, NY 11209</td>
<td>Bay Ridge</td>
<td>7506 3rd Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (582188.160 4498283.901)</td>
<td>128.852259</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>E.A.T.</td>
<td>$30–50</td>
<td>American restaurant</td>
<td>1064 Madison Ave, New York, NY 10028</td>
<td>Manhattan</td>
<td>1064 Madison Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (587622.919 4514556.245)</td>
<td>550.739266</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Dowling's at The Carlyle</td>
<td>$100+</td>
<td>Restaurant</td>
<td>35 E 76th St, New York, NY 10021</td>
<td>Manhattan</td>
<td>35 E 76th St</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (587497.885 4514233.353)</td>
<td>429.052337</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="public-transportation-accessibility" class="level1">
<h1>02 Public Transportation Accessibility</h1>
<p>To measure accessibility, we calculated the number of bus stops and subway stations within a 500-meter radius of each restaurant. A combined Public Transport Score was created to quantify the convenience of reaching these locations via public transit.</p>
<div id="fb42a529-73a7-4c82-b647-bf19fe9eaeaa" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shapely.geometry <span class="im">import</span> Point</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>bus_shelters <span class="op">=</span> pd.read_csv(<span class="st">"Bus_Stop_Shelter_20241215.csv"</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>bus_shelters_gdf <span class="op">=</span> gpd.GeoDataFrame(bus_shelters, </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                                   geometry<span class="op">=</span>gpd.points_from_xy(bus_shelters[<span class="st">'Longitude'</span>], bus_shelters[<span class="st">'Latitude'</span>]),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                                   crs<span class="op">=</span><span class="st">"EPSG:4326"</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>subway_stations <span class="op">=</span> pd.read_csv(<span class="st">"MTA_Subway_Stations_20241216.csv"</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>subway_gdf <span class="op">=</span> gpd.GeoDataFrame(subway_stations, </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>                              geometry<span class="op">=</span>gpd.points_from_xy(subway_stations[<span class="st">'GTFS Longitude'</span>], subway_stations[<span class="st">'GTFS Latitude'</span>]),</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                              crs<span class="op">=</span><span class="st">"EPSG:4326"</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>info_cleaned <span class="op">=</span> info_cleaned.to_crs(epsg<span class="op">=</span><span class="dv">32618</span>)</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>bus_shelters_gdf <span class="op">=</span> bus_shelters_gdf.to_crs(epsg<span class="op">=</span><span class="dv">32618</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>subway_gdf <span class="op">=</span> subway_gdf.to_crs(epsg<span class="op">=</span><span class="dv">32618</span>)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>buffer_radius <span class="op">=</span> <span class="dv">500</span> </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>info_cleaned[<span class="st">'buffer'</span>] <span class="op">=</span> info_cleaned.geometry.<span class="bu">buffer</span>(buffer_radius)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_within_buffer(<span class="bu">buffer</span>, gdf):</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> gdf.within(<span class="bu">buffer</span>).<span class="bu">sum</span>()</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>info_cleaned[<span class="st">'bus_count_500m'</span>] <span class="op">=</span> info_cleaned[<span class="st">'buffer'</span>].<span class="bu">apply</span>(</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> buf: count_within_buffer(buf, bus_shelters_gdf)</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>info_cleaned[<span class="st">'subway_count_500m'</span>] <span class="op">=</span> info_cleaned[<span class="st">'buffer'</span>].<span class="bu">apply</span>(</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> buf: count_within_buffer(buf, subway_gdf)</span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>info_cleaned[<span class="st">'public_transport_score'</span>] <span class="op">=</span> info_cleaned[<span class="st">'bus_count_500m'</span>] <span class="op">*</span> <span class="dv">1</span> <span class="op">+</span> info_cleaned[<span class="st">'subway_count_500m'</span>] <span class="op">*</span> <span class="dv">3</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>info_cleaned <span class="op">=</span> info_cleaned.drop(columns<span class="op">=</span><span class="st">'buffer'</span>)</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>info_cleaned.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">categoryName</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">neighborhood</th>
<th data-quarto-table-cell-role="th">street</th>
<th data-quarto-table-cell-role="th">url</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">nearest_parking_distance</th>
<th data-quarto-table-cell-role="th">bus_count_500m</th>
<th data-quarto-table-cell-role="th">subway_count_500m</th>
<th data-quarto-table-cell-role="th">public_transport_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Phil-Am Kusina</td>
<td>$10–20</td>
<td>Filipino restaurant</td>
<td>556 Tompkins Ave., Staten Island, NY 10305</td>
<td>Rosebank</td>
<td>556 Tompkins Ave.</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (578550.560 4496152.507)</td>
<td>23.399102</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>H &amp; L Bagels</td>
<td>$1–10</td>
<td>Bagel shop</td>
<td>8818 3rd Ave, Brooklyn, NY 11209</td>
<td>Fort Hamilton</td>
<td>8818 3rd Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (581871.546 4497205.555)</td>
<td>131.466634</td>
<td>3</td>
<td>1</td>
<td>6</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Coszcal De Allende</td>
<td>$30–50</td>
<td>Mexican restaurant</td>
<td>7506 3rd Ave, Brooklyn, NY 11209</td>
<td>Bay Ridge</td>
<td>7506 3rd Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (582188.160 4498283.901)</td>
<td>128.852259</td>
<td>5</td>
<td>1</td>
<td>8</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>E.A.T.</td>
<td>$30–50</td>
<td>American restaurant</td>
<td>1064 Madison Ave, New York, NY 10028</td>
<td>Manhattan</td>
<td>1064 Madison Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (587622.919 4514556.245)</td>
<td>550.739266</td>
<td>2</td>
<td>1</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Dowling's at The Carlyle</td>
<td>$100+</td>
<td>Restaurant</td>
<td>35 E 76th St, New York, NY 10021</td>
<td>Manhattan</td>
<td>35 E 76th St</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (587497.885 4514233.353)</td>
<td>429.052337</td>
<td>6</td>
<td>1</td>
<td>9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="proximity-to-romantic-locations" class="level1">
<h1>03 Proximity to Romantic Locations</h1>
<div id="bcd1e592-0ee5-4533-b15a-c66c41cdb6be" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> osmnx <span class="im">as</span> ox</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shapely.ops <span class="im">import</span> nearest_points</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>city <span class="op">=</span> <span class="st">"New York City, New York, USA"</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>parks <span class="op">=</span> ox.geometries_from_place(city, tags<span class="op">=</span>{<span class="st">'leisure'</span>: <span class="st">'park'</span>})</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>waterfronts <span class="op">=</span> ox.geometries_from_place(city, tags<span class="op">=</span>{<span class="st">'natural'</span>: <span class="st">'water'</span>, <span class="st">'leisure'</span>: <span class="st">'park'</span>})</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>culture_areas <span class="op">=</span> ox.geometries_from_place(city, tags<span class="op">=</span>{<span class="st">'tourism'</span>: <span class="st">'museum'</span>})</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>sculpture_gardens <span class="op">=</span> ox.geometries_from_place(city, tags<span class="op">=</span>{<span class="st">'leisure'</span>: <span class="st">'garden'</span>})</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>points_of_interest <span class="op">=</span> pd.concat([parks, waterfronts, culture_areas, sculpture_gardens])</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>points_of_interest <span class="op">=</span> points_of_interest[points_of_interest.geometry.notnull()]</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>points_of_interest <span class="op">=</span> points_of_interest.to_crs(epsg<span class="op">=</span><span class="dv">32618</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>info_cleaned <span class="op">=</span> info_cleaned.to_crs(epsg<span class="op">=</span><span class="dv">32618</span>)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nearest_distance(row, poi_gdf):</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    nearest_geom <span class="op">=</span> poi_gdf.geometry.<span class="bu">apply</span>(<span class="kw">lambda</span> geom: row.geometry.distance(geom))</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nearest_geom.<span class="bu">min</span>()</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>info_cleaned[<span class="st">'nearest_romantic_distance'</span>] <span class="op">=</span> info_cleaned.<span class="bu">apply</span>(</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> row: nearest_distance(row, points_of_interest), axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(info_cleaned[[<span class="st">'title'</span>, <span class="st">'nearest_romantic_distance'</span>]].head())</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>points_of_interest.plot(ax<span class="op">=</span>ax, color<span class="op">=</span><span class="st">'green'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="st">'Romantic Points'</span>)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>info_cleaned.plot(ax<span class="op">=</span>ax, color<span class="op">=</span><span class="st">'red'</span>, markersize<span class="op">=</span><span class="dv">5</span>, label<span class="op">=</span><span class="st">'Restaurants'</span>)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Restaurants and Romantic Locations in NYC"</span>)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/7h/jtn8ncw16d59q490lkn0lqlh0000gn/T/ipykernel_94434/3253382405.py:12: FutureWarning: The `geometries` module and `geometries_from_X` functions have been renamed the `features` module and `features_from_X` functions. Use these instead. The `geometries` module and function names are deprecated and will be removed in the v2.0.0 release. See the OSMnx v2 migration guide: https://github.com/gboeing/osmnx/issues/1123
  parks = ox.geometries_from_place(city, tags={'leisure': 'park'})
/var/folders/7h/jtn8ncw16d59q490lkn0lqlh0000gn/T/ipykernel_94434/3253382405.py:13: FutureWarning: The `geometries` module and `geometries_from_X` functions have been renamed the `features` module and `features_from_X` functions. Use these instead. The `geometries` module and function names are deprecated and will be removed in the v2.0.0 release. See the OSMnx v2 migration guide: https://github.com/gboeing/osmnx/issues/1123
  waterfronts = ox.geometries_from_place(city, tags={'natural': 'water', 'leisure': 'park'})
/var/folders/7h/jtn8ncw16d59q490lkn0lqlh0000gn/T/ipykernel_94434/3253382405.py:14: FutureWarning: The `geometries` module and `geometries_from_X` functions have been renamed the `features` module and `features_from_X` functions. Use these instead. The `geometries` module and function names are deprecated and will be removed in the v2.0.0 release. See the OSMnx v2 migration guide: https://github.com/gboeing/osmnx/issues/1123
  culture_areas = ox.geometries_from_place(city, tags={'tourism': 'museum'})
/var/folders/7h/jtn8ncw16d59q490lkn0lqlh0000gn/T/ipykernel_94434/3253382405.py:15: FutureWarning: The `geometries` module and `geometries_from_X` functions have been renamed the `features` module and `features_from_X` functions. Use these instead. The `geometries` module and function names are deprecated and will be removed in the v2.0.0 release. See the OSMnx v2 migration guide: https://github.com/gboeing/osmnx/issues/1123
  sculpture_gardens = ox.geometries_from_place(city, tags={'leisure': 'garden'})</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                      title  nearest_romantic_distance
0            Phil-Am Kusina                 284.550961
1              H &amp; L Bagels                 404.126647
2        Coszcal De Allende                 290.370106
3                    E.A.T.                 145.836623
4  Dowling's at The Carlyle                 126.697833</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/7h/jtn8ncw16d59q490lkn0lqlh0000gn/T/ipykernel_94434/3253382405.py:45: UserWarning: Legend does not support handles for PatchCollection instances.
See: https://matplotlib.org/stable/tutorials/intermediate/legend_guide.html#implementing-a-custom-legend-handler
  plt.legend()</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3_NYC_Restaurant_EnvironmentData_files/figure-html/cell-10-output-4.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="2e878a8d-5a93-425d-8e3c-5735a110ba7a" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>info_cleaned.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">categoryName</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">neighborhood</th>
<th data-quarto-table-cell-role="th">street</th>
<th data-quarto-table-cell-role="th">url</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">nearest_parking_distance</th>
<th data-quarto-table-cell-role="th">bus_count_500m</th>
<th data-quarto-table-cell-role="th">subway_count_500m</th>
<th data-quarto-table-cell-role="th">public_transport_score</th>
<th data-quarto-table-cell-role="th">nearest_romantic_distance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Phil-Am Kusina</td>
<td>$10–20</td>
<td>Filipino restaurant</td>
<td>556 Tompkins Ave., Staten Island, NY 10305</td>
<td>Rosebank</td>
<td>556 Tompkins Ave.</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (578550.560 4496152.507)</td>
<td>23.399102</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>284.550961</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>H &amp; L Bagels</td>
<td>$1–10</td>
<td>Bagel shop</td>
<td>8818 3rd Ave, Brooklyn, NY 11209</td>
<td>Fort Hamilton</td>
<td>8818 3rd Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (581871.546 4497205.555)</td>
<td>131.466634</td>
<td>3</td>
<td>1</td>
<td>6</td>
<td>404.126647</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Coszcal De Allende</td>
<td>$30–50</td>
<td>Mexican restaurant</td>
<td>7506 3rd Ave, Brooklyn, NY 11209</td>
<td>Bay Ridge</td>
<td>7506 3rd Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (582188.160 4498283.901)</td>
<td>128.852259</td>
<td>5</td>
<td>1</td>
<td>8</td>
<td>290.370106</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>E.A.T.</td>
<td>$30–50</td>
<td>American restaurant</td>
<td>1064 Madison Ave, New York, NY 10028</td>
<td>Manhattan</td>
<td>1064 Madison Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (587622.919 4514556.245)</td>
<td>550.739266</td>
<td>2</td>
<td>1</td>
<td>5</td>
<td>145.836623</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Dowling's at The Carlyle</td>
<td>$100+</td>
<td>Restaurant</td>
<td>35 E 76th St, New York, NY 10021</td>
<td>Manhattan</td>
<td>35 E 76th St</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (587497.885 4514233.353)</td>
<td>429.052337</td>
<td>6</td>
<td>1</td>
<td>9</td>
<td>126.697833</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="import-noises-complaints-data" class="level1">
<h1>Import Noises Complaints Data</h1>
<div id="fd6be97e-b8b0-4889-8361-4794ef6d9553" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> osmnx <span class="im">as</span> ox</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> shapely.geometry <span class="im">import</span> Point</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>noise_file <span class="op">=</span> <span class="st">'311_Noise_Complaints.csv'</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(noise_file)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna(subset<span class="op">=</span>[<span class="st">'Latitude'</span>, <span class="st">'Longitude'</span>])</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>geometry <span class="op">=</span> [Point(xy) <span class="cf">for</span> xy <span class="kw">in</span> <span class="bu">zip</span>(df[<span class="st">'Longitude'</span>], df[<span class="st">'Latitude'</span>])]</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>noise_gdf <span class="op">=</span> gpd.GeoDataFrame(df, geometry<span class="op">=</span>geometry, crs<span class="op">=</span><span class="st">'EPSG:4326'</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>noise_gdf.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/7h/jtn8ncw16d59q490lkn0lqlh0000gn/T/ipykernel_94434/1095868831.py:8: DtypeWarning: Columns (29) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(noise_file)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Unique Key</th>
<th data-quarto-table-cell-role="th">Created Date</th>
<th data-quarto-table-cell-role="th">Closed Date</th>
<th data-quarto-table-cell-role="th">Agency</th>
<th data-quarto-table-cell-role="th">Agency Name</th>
<th data-quarto-table-cell-role="th">Complaint Type</th>
<th data-quarto-table-cell-role="th">Descriptor</th>
<th data-quarto-table-cell-role="th">Location Type</th>
<th data-quarto-table-cell-role="th">Incident Zip</th>
<th data-quarto-table-cell-role="th">Incident Address</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Taxi Company Borough</th>
<th data-quarto-table-cell-role="th">Taxi Pick Up Location</th>
<th data-quarto-table-cell-role="th">Bridge Highway Name</th>
<th data-quarto-table-cell-role="th">Bridge Highway Direction</th>
<th data-quarto-table-cell-role="th">Road Ramp</th>
<th data-quarto-table-cell-role="th">Bridge Highway Segment</th>
<th data-quarto-table-cell-role="th">Latitude</th>
<th data-quarto-table-cell-role="th">Longitude</th>
<th data-quarto-table-cell-role="th">Location</th>
<th data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>56416252</td>
<td>01/01/2023 12:00:42 AM</td>
<td>01/01/2023 05:34:15 PM</td>
<td>NYPD</td>
<td>New York City Police Department</td>
<td>Noise - Residential</td>
<td>Loud Music/Party</td>
<td>Residential Building/House</td>
<td>10453.0</td>
<td>1871 SEDGWICK AVENUE</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>40.853848</td>
<td>-73.917709</td>
<td>(40.85384789145288, -73.91770920479841)</td>
<td>POINT (-73.91771 40.85385)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>56418136</td>
<td>01/01/2023 12:00:46 AM</td>
<td>01/01/2023 01:01:43 AM</td>
<td>NYPD</td>
<td>New York City Police Department</td>
<td>Noise - Residential</td>
<td>Loud Music/Party</td>
<td>Residential Building/House</td>
<td>11234.0</td>
<td>1621 EAST 51 STREET</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>40.620665</td>
<td>-73.926040</td>
<td>(40.62066491675458, -73.92604033064251)</td>
<td>POINT (-73.92604 40.62066)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>56418977</td>
<td>01/01/2023 12:01:38 AM</td>
<td>01/01/2023 03:24:32 AM</td>
<td>NYPD</td>
<td>New York City Police Department</td>
<td>Noise - Residential</td>
<td>Loud Music/Party</td>
<td>Residential Building/House</td>
<td>11429.0</td>
<td>206-20 104 AVENUE</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>40.710379</td>
<td>-73.752158</td>
<td>(40.71037925060261, -73.75215815961971)</td>
<td>POINT (-73.75216 40.71038)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>56413435</td>
<td>01/01/2023 12:01:54 AM</td>
<td>01/01/2023 12:43:40 AM</td>
<td>NYPD</td>
<td>New York City Police Department</td>
<td>Noise - Street/Sidewalk</td>
<td>Loud Talking</td>
<td>Street/Sidewalk</td>
<td>11218.0</td>
<td>15 AVENUE</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>40.639686</td>
<td>-73.979909</td>
<td>(40.63968638126339, -73.97990859982983)</td>
<td>POINT (-73.97991 40.63969)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>56412730</td>
<td>01/01/2023 12:01:57 AM</td>
<td>01/01/2023 12:49:42 AM</td>
<td>NYPD</td>
<td>New York City Police Department</td>
<td>Noise - Commercial</td>
<td>Loud Music/Party</td>
<td>Store/Commercial</td>
<td>11378.0</td>
<td>70-10 GRAND AVENUE</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>40.727633</td>
<td>-73.892487</td>
<td>(40.72763257870112, -73.89248674712505)</td>
<td>POINT (-73.89249 40.72763)</td>
</tr>
</tbody>
</table>

<p>5 rows × 40 columns</p>
</div>
</div>
</div>
<div id="c2ffb267-aa26-4c6d-bbaf-0fe0e90fb45a" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> osmnx <span class="im">as</span> ox</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>place_name <span class="op">=</span> <span class="st">"New York City, New York, USA"</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>streets <span class="op">=</span> ox.graph_from_place(place_name, network_type<span class="op">=</span><span class="st">'drive'</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>street_gdf <span class="op">=</span> ox.graph_to_gdfs(streets, nodes<span class="op">=</span><span class="va">False</span>)  </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>street_gdf <span class="op">=</span> street_gdf.to_crs(epsg<span class="op">=</span><span class="dv">32618</span>)  </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>street_gdf.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">osmid</th>
<th data-quarto-table-cell-role="th">oneway</th>
<th data-quarto-table-cell-role="th">lanes</th>
<th data-quarto-table-cell-role="th">ref</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">highway</th>
<th data-quarto-table-cell-role="th">maxspeed</th>
<th data-quarto-table-cell-role="th">reversed</th>
<th data-quarto-table-cell-role="th">length</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">bridge</th>
<th data-quarto-table-cell-role="th">access</th>
<th data-quarto-table-cell-role="th">tunnel</th>
<th data-quarto-table-cell-role="th">width</th>
<th data-quarto-table-cell-role="th">junction</th>
<th data-quarto-table-cell-role="th">est_width</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">u</th>
<th data-quarto-table-cell-role="th">v</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">39076461</td>
<td data-quarto-table-cell-role="th">274283981</td>
<td data-quarto-table-cell-role="th">0</td>
<td>25161349</td>
<td>True</td>
<td>2</td>
<td>CI</td>
<td>Cross Island Parkway</td>
<td>motorway</td>
<td>50 mph</td>
<td>False</td>
<td>819.503</td>
<td>LINESTRING (601691.230 4515738.523, 601702.418...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">42854803</td>
<td data-quarto-table-cell-role="th">0</td>
<td>25161578</td>
<td>True</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>motorway_link</td>
<td>NaN</td>
<td>False</td>
<td>268.145</td>
<td>LINESTRING (601691.230 4515738.523, 601811.421...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">39076490</td>
<td data-quarto-table-cell-role="th">277672046</td>
<td data-quarto-table-cell-role="th">0</td>
<td>5699971</td>
<td>True</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>motorway_link</td>
<td>NaN</td>
<td>False</td>
<td>259.674</td>
<td>LINESTRING (604906.239 4513128.015, 604895.878...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">277672005</td>
<td data-quarto-table-cell-role="th">0</td>
<td>1014007069</td>
<td>True</td>
<td>3</td>
<td>CI</td>
<td>Cross Island Parkway</td>
<td>motorway</td>
<td>50 mph</td>
<td>False</td>
<td>291.839</td>
<td>LINESTRING (604906.239 4513128.015, 604878.921...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">39076504</td>
<td data-quarto-table-cell-role="th">462124701</td>
<td data-quarto-table-cell-role="th">0</td>
<td>[618709517, 618709515, 5700693]</td>
<td>True</td>
<td>1</td>
<td>NaN</td>
<td>NaN</td>
<td>motorway_link</td>
<td>NaN</td>
<td>False</td>
<td>433.148</td>
<td>LINESTRING (606011.533 4512148.657, 605979.445...</td>
<td>yes</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="7babd7f1-23ec-438b-9a0f-e0df9bba3a00" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>street_gdf <span class="op">=</span> street_gdf.drop(columns<span class="op">=</span>[<span class="st">'u'</span>, <span class="st">'v'</span>, <span class="st">'key'</span>], errors<span class="op">=</span><span class="st">'ignore'</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>noise_gdf <span class="op">=</span> noise_gdf.to_crs(epsg<span class="op">=</span><span class="dv">32618</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>joined <span class="op">=</span> gpd.sjoin_nearest(noise_gdf, street_gdf, how<span class="op">=</span><span class="st">'left'</span>, distance_col<span class="op">=</span><span class="st">'distance'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b4eb864e-2f92-457c-8cc5-ffc56d40d365" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>joined.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Unique Key</th>
<th data-quarto-table-cell-role="th">Created Date</th>
<th data-quarto-table-cell-role="th">Closed Date</th>
<th data-quarto-table-cell-role="th">Agency</th>
<th data-quarto-table-cell-role="th">Agency Name</th>
<th data-quarto-table-cell-role="th">Complaint Type</th>
<th data-quarto-table-cell-role="th">Descriptor</th>
<th data-quarto-table-cell-role="th">Location Type</th>
<th data-quarto-table-cell-role="th">Incident Zip</th>
<th data-quarto-table-cell-role="th">Incident Address</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">maxspeed</th>
<th data-quarto-table-cell-role="th">reversed</th>
<th data-quarto-table-cell-role="th">length</th>
<th data-quarto-table-cell-role="th">bridge</th>
<th data-quarto-table-cell-role="th">access</th>
<th data-quarto-table-cell-role="th">tunnel</th>
<th data-quarto-table-cell-role="th">width</th>
<th data-quarto-table-cell-role="th">junction</th>
<th data-quarto-table-cell-role="th">est_width</th>
<th data-quarto-table-cell-role="th">distance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>56416252</td>
<td>01/01/2023 12:00:42 AM</td>
<td>01/01/2023 05:34:15 PM</td>
<td>NYPD</td>
<td>New York City Police Department</td>
<td>Noise - Residential</td>
<td>Loud Music/Party</td>
<td>Residential Building/House</td>
<td>10453.0</td>
<td>1871 SEDGWICK AVENUE</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>171.798</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.253069</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>56418136</td>
<td>01/01/2023 12:00:46 AM</td>
<td>01/01/2023 01:01:43 AM</td>
<td>NYPD</td>
<td>New York City Police Department</td>
<td>Noise - Residential</td>
<td>Loud Music/Party</td>
<td>Residential Building/House</td>
<td>11234.0</td>
<td>1621 EAST 51 STREET</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>267.759</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.872901</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>56418977</td>
<td>01/01/2023 12:01:38 AM</td>
<td>01/01/2023 03:24:32 AM</td>
<td>NYPD</td>
<td>New York City Police Department</td>
<td>Noise - Residential</td>
<td>Loud Music/Party</td>
<td>Residential Building/House</td>
<td>11429.0</td>
<td>206-20 104 AVENUE</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>75.139</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1.916960</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>56413435</td>
<td>01/01/2023 12:01:54 AM</td>
<td>01/01/2023 12:43:40 AM</td>
<td>NYPD</td>
<td>New York City Police Department</td>
<td>Noise - Street/Sidewalk</td>
<td>Loud Talking</td>
<td>Street/Sidewalk</td>
<td>11218.0</td>
<td>15 AVENUE</td>
<td>...</td>
<td>NaN</td>
<td>False</td>
<td>59.402</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.122752</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>56412730</td>
<td>01/01/2023 12:01:57 AM</td>
<td>01/01/2023 12:49:42 AM</td>
<td>NYPD</td>
<td>New York City Police Department</td>
<td>Noise - Commercial</td>
<td>Loud Music/Party</td>
<td>Store/Commercial</td>
<td>11378.0</td>
<td>70-10 GRAND AVENUE</td>
<td>...</td>
<td>25 mph</td>
<td>False</td>
<td>104.863</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>2.388616</td>
</tr>
</tbody>
</table>

<p>5 rows × 59 columns</p>
</div>
</div>
</div>
<div id="a5d9a853-b5a4-406e-aae8-9c1b1039650b" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>noise_gdf <span class="op">=</span> noise_gdf.to_crs(epsg<span class="op">=</span><span class="dv">32618</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>street_gdf <span class="op">=</span> street_gdf.to_crs(epsg<span class="op">=</span><span class="dv">32618</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>joined <span class="op">=</span> gpd.sjoin_nearest(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    noise_gdf, street_gdf, how<span class="op">=</span><span class="st">'left'</span>, distance_col<span class="op">=</span><span class="st">'distance'</span>, max_distance<span class="op">=</span><span class="dv">100</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>street_gdf[<span class="st">'osmid'</span>] <span class="op">=</span> street_gdf[<span class="st">'osmid'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="dv">0</span>] <span class="cf">if</span> <span class="bu">isinstance</span>(x, <span class="bu">list</span>) <span class="cf">else</span> x)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>joined[<span class="st">'osmid'</span>] <span class="op">=</span> joined[<span class="st">'osmid'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="dv">0</span>] <span class="cf">if</span> <span class="bu">isinstance</span>(x, <span class="bu">list</span>) <span class="cf">else</span> x)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>street_noise_count <span class="op">=</span> joined.groupby(<span class="st">'osmid'</span>).size()</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>street_gdf[<span class="st">'noise_count'</span>] <span class="op">=</span> street_gdf[<span class="st">'osmid'</span>].<span class="bu">map</span>(street_noise_count).fillna(<span class="dv">0</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>street_gdf[[<span class="st">'osmid'</span>, <span class="st">'noise_count'</span>]].head(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">osmid</th>
<th data-quarto-table-cell-role="th">noise_count</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">u</th>
<th data-quarto-table-cell-role="th">v</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">39076461</td>
<td data-quarto-table-cell-role="th">274283981</td>
<td data-quarto-table-cell-role="th">0</td>
<td>25161349</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">42854803</td>
<td data-quarto-table-cell-role="th">0</td>
<td>25161578</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">39076490</td>
<td data-quarto-table-cell-role="th">277672046</td>
<td data-quarto-table-cell-role="th">0</td>
<td>5699971</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">277672005</td>
<td data-quarto-table-cell-role="th">0</td>
<td>1014007069</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">39076504</td>
<td data-quarto-table-cell-role="th">462124701</td>
<td data-quarto-table-cell-role="th">0</td>
<td>618709517</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">462122450</td>
<td data-quarto-table-cell-role="th">0</td>
<td>995490141</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">42421728</td>
<td data-quarto-table-cell-role="th">42435337</td>
<td data-quarto-table-cell-role="th">0</td>
<td>195743153</td>
<td>36.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">42421731</td>
<td data-quarto-table-cell-role="th">0</td>
<td>420625565</td>
<td>125.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42432736</td>
<td data-quarto-table-cell-role="th">0</td>
<td>1271523197</td>
<td>102.0</td>
</tr>
<tr class="even">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">42421731</td>
<td data-quarto-table-cell-role="th">42437916</td>
<td data-quarto-table-cell-role="th">0</td>
<td>5671485</td>
<td>608.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42432737</td>
<td data-quarto-table-cell-role="th">0</td>
<td>195743186</td>
<td>109.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">42421728</td>
<td data-quarto-table-cell-role="th">0</td>
<td>420625565</td>
<td>125.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42421737</td>
<td data-quarto-table-cell-role="th">0</td>
<td>195743201</td>
<td>168.0</td>
</tr>
<tr class="even">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">42421737</td>
<td data-quarto-table-cell-role="th">42421731</td>
<td data-quarto-table-cell-role="th">0</td>
<td>195743201</td>
<td>168.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42437917</td>
<td data-quarto-table-cell-role="th">0</td>
<td>420625563</td>
<td>169.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">42421741</td>
<td data-quarto-table-cell-role="th">0</td>
<td>420625567</td>
<td>73.0</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">42421741</td>
<td data-quarto-table-cell-role="th">42432756</td>
<td data-quarto-table-cell-role="th">0</td>
<td>957050578</td>
<td>144.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1061531654</td>
<td data-quarto-table-cell-role="th">0</td>
<td>420625569</td>
<td>62.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42421737</td>
<td data-quarto-table-cell-role="th">0</td>
<td>420625567</td>
<td>73.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">42421745</td>
<td data-quarto-table-cell-role="th">1061531654</td>
<td data-quarto-table-cell-role="th">0</td>
<td>195743200</td>
<td>10.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="16a1e626-f062-475b-8382-be1e173c68c0" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">12</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>street_gdf.plot(</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span>ax,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    column<span class="op">=</span><span class="st">'noise_count'</span>,  </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">'Reds'</span>, </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    linewidth<span class="op">=</span><span class="dv">1</span>,  </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    legend<span class="op">=</span><span class="va">True</span>,  </span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    alpha<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span>street_gdf[<span class="st">'noise_count'</span>].quantile(<span class="fl">0.95</span>) </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Noise Complaint Density Mapped to NYC Streets"</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Longitude"</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Latitude"</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3_NYC_Restaurant_EnvironmentData_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="0645b5c3-d4bd-40e3-926f-24976879e409" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>info_cleaned <span class="op">=</span> info_cleaned.to_crs(epsg<span class="op">=</span><span class="dv">32618</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>street_gdf <span class="op">=</span> street_gdf.to_crs(epsg<span class="op">=</span><span class="dv">32618</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>info_cleaned <span class="op">=</span> info_cleaned.reset_index(drop<span class="op">=</span><span class="va">False</span>)  <span class="co"># 将索引变为列，保留原始索引</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>info_cleaned.rename(columns<span class="op">=</span>{<span class="st">'index'</span>: <span class="st">'restaurant_id'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>restaurant_with_street <span class="op">=</span> gpd.sjoin_nearest(</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    info_cleaned, </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    street_gdf[[<span class="st">'osmid'</span>, <span class="st">'noise_count'</span>, <span class="st">'geometry'</span>]], </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">'left'</span>, </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    distance_col<span class="op">=</span><span class="st">'distance_to_street'</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>restaurant_with_street <span class="op">=</span> restaurant_with_street.sort_values(by<span class="op">=</span><span class="st">'distance_to_street'</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>restaurant_with_street <span class="op">=</span> restaurant_with_street.drop_duplicates(subset<span class="op">=</span><span class="st">'restaurant_id'</span>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>info_cleaned[<span class="st">'noise_count'</span>] <span class="op">=</span> restaurant_with_street.set_index(<span class="st">'restaurant_id'</span>)[<span class="st">'noise_count'</span>].fillna(<span class="dv">0</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>info_cleaned.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">restaurant_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">categoryName</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">neighborhood</th>
<th data-quarto-table-cell-role="th">street</th>
<th data-quarto-table-cell-role="th">url</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">nearest_parking_distance</th>
<th data-quarto-table-cell-role="th">bus_count_500m</th>
<th data-quarto-table-cell-role="th">subway_count_500m</th>
<th data-quarto-table-cell-role="th">public_transport_score</th>
<th data-quarto-table-cell-role="th">nearest_romantic_distance</th>
<th data-quarto-table-cell-role="th">noise_count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>Phil-Am Kusina</td>
<td>$10–20</td>
<td>Filipino restaurant</td>
<td>556 Tompkins Ave., Staten Island, NY 10305</td>
<td>Rosebank</td>
<td>556 Tompkins Ave.</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (578550.560 4496152.507)</td>
<td>23.399102</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>284.550961</td>
<td>7.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>H &amp; L Bagels</td>
<td>$1–10</td>
<td>Bagel shop</td>
<td>8818 3rd Ave, Brooklyn, NY 11209</td>
<td>Fort Hamilton</td>
<td>8818 3rd Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (581871.546 4497205.555)</td>
<td>131.466634</td>
<td>3</td>
<td>1</td>
<td>6</td>
<td>404.126647</td>
<td>508.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>Coszcal De Allende</td>
<td>$30–50</td>
<td>Mexican restaurant</td>
<td>7506 3rd Ave, Brooklyn, NY 11209</td>
<td>Bay Ridge</td>
<td>7506 3rd Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (582188.160 4498283.901)</td>
<td>128.852259</td>
<td>5</td>
<td>1</td>
<td>8</td>
<td>290.370106</td>
<td>457.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>E.A.T.</td>
<td>$30–50</td>
<td>American restaurant</td>
<td>1064 Madison Ave, New York, NY 10028</td>
<td>Manhattan</td>
<td>1064 Madison Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (587622.919 4514556.245)</td>
<td>550.739266</td>
<td>2</td>
<td>1</td>
<td>5</td>
<td>145.836623</td>
<td>39.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>Dowling's at The Carlyle</td>
<td>$100+</td>
<td>Restaurant</td>
<td>35 E 76th St, New York, NY 10021</td>
<td>Manhattan</td>
<td>35 E 76th St</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (587497.885 4514233.353)</td>
<td>429.052337</td>
<td>6</td>
<td>1</td>
<td>9</td>
<td>126.697833</td>
<td>270.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="import-median-hh-income-data" class="level1">
<h1>Import Median HH Income Data</h1>
<div id="c4668bc2-4435-44ea-89a5-fd006865f26c" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>tracts_gdf <span class="op">=</span> gpd.read_file(<span class="st">"income.geojson"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="566ab687-d121-493f-bf23-25095ba558d4" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>info_cleaned <span class="op">=</span> info_cleaned.to_crs(tracts_gdf.crs)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>info_with_income <span class="op">=</span> gpd.sjoin(</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    info_cleaned, </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    tracts_gdf[[<span class="st">'geometry'</span>, <span class="st">'Median_Household_Income'</span>]], </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">'left'</span>, </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    predicate<span class="op">=</span><span class="st">'within'</span>  </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>info_with_income <span class="op">=</span> info_with_income.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>info_cleaned <span class="op">=</span> info_cleaned.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>info_cleaned[<span class="st">'Median_Household_Income'</span>] <span class="op">=</span> info_with_income[<span class="st">'Median_Household_Income'</span>].fillna(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="bed470b8-1319-4950-b818-329231f9511d" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>info_cleaned.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">restaurant_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">categoryName</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">neighborhood</th>
<th data-quarto-table-cell-role="th">street</th>
<th data-quarto-table-cell-role="th">url</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">nearest_parking_distance</th>
<th data-quarto-table-cell-role="th">bus_count_500m</th>
<th data-quarto-table-cell-role="th">subway_count_500m</th>
<th data-quarto-table-cell-role="th">public_transport_score</th>
<th data-quarto-table-cell-role="th">nearest_romantic_distance</th>
<th data-quarto-table-cell-role="th">noise_count</th>
<th data-quarto-table-cell-role="th">Median_Household_Income</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>Phil-Am Kusina</td>
<td>$10–20</td>
<td>Filipino restaurant</td>
<td>556 Tompkins Ave., Staten Island, NY 10305</td>
<td>Rosebank</td>
<td>556 Tompkins Ave.</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (964418.659 162421.004)</td>
<td>23.399102</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>284.550961</td>
<td>7.0</td>
<td>85183.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>H &amp; L Bagels</td>
<td>$1–10</td>
<td>Bagel shop</td>
<td>8818 3rd Ave, Brooklyn, NY 11209</td>
<td>Fort Hamilton</td>
<td>8818 3rd Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (975356.367 165752.902)</td>
<td>131.466634</td>
<td>3</td>
<td>1</td>
<td>6</td>
<td>404.126647</td>
<td>508.0</td>
<td>86582.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>Coszcal De Allende</td>
<td>$30–50</td>
<td>Mexican restaurant</td>
<td>7506 3rd Ave, Brooklyn, NY 11209</td>
<td>Bay Ridge</td>
<td>7506 3rd Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (976435.614 169279.869)</td>
<td>128.852259</td>
<td>5</td>
<td>1</td>
<td>8</td>
<td>290.370106</td>
<td>457.0</td>
<td>88155.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>E.A.T.</td>
<td>$30–50</td>
<td>American restaurant</td>
<td>1064 Madison Ave, New York, NY 10028</td>
<td>Manhattan</td>
<td>1064 Madison Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (994878.394 222476.771)</td>
<td>550.739266</td>
<td>2</td>
<td>1</td>
<td>5</td>
<td>145.836623</td>
<td>39.0</td>
<td>202632.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>Dowling's at The Carlyle</td>
<td>$100+</td>
<td>Restaurant</td>
<td>35 E 76th St, New York, NY 10021</td>
<td>Manhattan</td>
<td>35 E 76th St</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (994456.004 221421.843)</td>
<td>429.052337</td>
<td>6</td>
<td>1</td>
<td>9</td>
<td>126.697833</td>
<td>270.0</td>
<td>69583.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="clean-the-price-column" class="level1">
<h1>Clean the ’Price‘ Column</h1>
<div id="03f1225d-3c02-4f34-bd22-dbb065c75cc7" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean_price(price):</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isnull(price):  <span class="co"># Handle missing values</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.nan</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> re.match(<span class="vs">r'\$\d+–\d+'</span>, price):</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        numbers <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, re.findall(<span class="vs">r'\d+'</span>, price)))  <span class="co"># Extract numbers</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.mean(numbers)  <span class="co"># Average of range</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> re.match(<span class="vs">r'\$\d+\+'</span>, price):</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">int</span>(re.findall(<span class="vs">r'\d+'</span>, price)[<span class="dv">0</span>])  </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> price <span class="op">==</span> <span class="st">'$'</span>:</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">10</span>  <span class="co"># Rank 1 (most affordable)</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> price <span class="op">==</span> <span class="st">'$$'</span>:</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">20</span>  <span class="co"># Rank 2</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> price <span class="op">==</span> <span class="st">'$$$'</span>:</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">50</span>  <span class="co"># Rank 3</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> price <span class="op">==</span> <span class="st">'$$$$'</span>:</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">100</span>  <span class="co"># Rank 4 (most expensive)</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.nan</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>info_cleaned[<span class="st">'price_cleaned'</span>] <span class="op">=</span> info_cleaned[<span class="st">'price'</span>].<span class="bu">apply</span>(clean_price)</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>info_cleaned[<span class="st">'price_cleaned'</span>] <span class="op">=</span> info_cleaned[<span class="st">'price_cleaned'</span>].fillna(info_cleaned[<span class="st">'price_cleaned'</span>].median())</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Cleaned 'price' column in info_cleaned:"</span>)</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(info_cleaned[[<span class="st">'price'</span>, <span class="st">'price_cleaned'</span>]].head(<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cleaned 'price' column in info_cleaned:
     price  price_cleaned
0   $10–20           15.0
1    $1–10            5.5
2   $30–50           40.0
3   $30–50           40.0
4    $100+          100.0
5   $20–30           25.0
6   $10–20           15.0
7    $100+          100.0
8  $50–100           75.0
9   $30–50           40.0</code></pre>
</div>
</div>
<div id="6cce9ce4-8e61-44b7-8a9f-0941fb6ac6ce" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>info_cleaned.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">restaurant_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">categoryName</th>
<th data-quarto-table-cell-role="th">address</th>
<th data-quarto-table-cell-role="th">neighborhood</th>
<th data-quarto-table-cell-role="th">street</th>
<th data-quarto-table-cell-role="th">url</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">nearest_parking_distance</th>
<th data-quarto-table-cell-role="th">bus_count_500m</th>
<th data-quarto-table-cell-role="th">subway_count_500m</th>
<th data-quarto-table-cell-role="th">public_transport_score</th>
<th data-quarto-table-cell-role="th">nearest_romantic_distance</th>
<th data-quarto-table-cell-role="th">noise_count</th>
<th data-quarto-table-cell-role="th">Median_Household_Income</th>
<th data-quarto-table-cell-role="th">price_cleaned</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>Phil-Am Kusina</td>
<td>$10–20</td>
<td>Filipino restaurant</td>
<td>556 Tompkins Ave., Staten Island, NY 10305</td>
<td>Rosebank</td>
<td>556 Tompkins Ave.</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (964418.659 162421.004)</td>
<td>23.399102</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>284.550961</td>
<td>7.0</td>
<td>85183.0</td>
<td>15.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>H &amp; L Bagels</td>
<td>$1–10</td>
<td>Bagel shop</td>
<td>8818 3rd Ave, Brooklyn, NY 11209</td>
<td>Fort Hamilton</td>
<td>8818 3rd Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (975356.367 165752.902)</td>
<td>131.466634</td>
<td>3</td>
<td>1</td>
<td>6</td>
<td>404.126647</td>
<td>508.0</td>
<td>86582.0</td>
<td>5.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>Coszcal De Allende</td>
<td>$30–50</td>
<td>Mexican restaurant</td>
<td>7506 3rd Ave, Brooklyn, NY 11209</td>
<td>Bay Ridge</td>
<td>7506 3rd Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (976435.614 169279.869)</td>
<td>128.852259</td>
<td>5</td>
<td>1</td>
<td>8</td>
<td>290.370106</td>
<td>457.0</td>
<td>88155.0</td>
<td>40.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>E.A.T.</td>
<td>$30–50</td>
<td>American restaurant</td>
<td>1064 Madison Ave, New York, NY 10028</td>
<td>Manhattan</td>
<td>1064 Madison Ave</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (994878.394 222476.771)</td>
<td>550.739266</td>
<td>2</td>
<td>1</td>
<td>5</td>
<td>145.836623</td>
<td>39.0</td>
<td>202632.0</td>
<td>40.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>Dowling's at The Carlyle</td>
<td>$100+</td>
<td>Restaurant</td>
<td>35 E 76th St, New York, NY 10021</td>
<td>Manhattan</td>
<td>35 E 76th St</td>
<td>https://www.google.com/maps/search/?api=1&amp;quer...</td>
<td>POINT (994456.004 221421.843)</td>
<td>429.052337</td>
<td>6</td>
<td>1</td>
<td>9</td>
<td>126.697833</td>
<td>270.0</td>
<td>69583.0</td>
<td>100.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="24d27baf-9724-4dac-b7eb-69bb6a723f64" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>output_path <span class="op">=</span> <span class="st">"restaurant_info_with_envifactors.geojson"</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>info_cleaned.to_file(output_path, driver<span class="op">=</span><span class="st">"GeoJSON"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Final Project</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>